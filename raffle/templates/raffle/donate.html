{# templates/raffle/donate.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}Donaciones para Milo{% endblock %}

{% block content %}
<div id="mp-config"
     data-public-key="{{ MP_PUBLIC_KEY }}">
</div>

<div class="max-w-2xl mx-auto">
  <div class="mb-6">
    <h1 class="text-2xl font-bold mb-2">Ayuda a Milo con una donaciÃ³n ğŸ’š</h1>

    {% if request.GET.ok %}
    <div class="mt-4 p-3 rounded-md bg-green-50 border border-green-300">
        <p class="text-green-800 font-semibold">
        Â¡Muchas gracias! ğŸ¶ğŸ’š  
        Tu donaciÃ³n ayudarÃ¡ directamente a que Milo pueda operarse y dejar de cojear.  
        Gracias por darle una oportunidad real de vivir sin dolor.
        </p>
    </div>
    {% endif %}

    {% if request.GET.fail %}
    <div class="mt-4 p-3 rounded-md bg-red-50 border border-red-300">
        <p class="text-red-800 font-semibold">
        El pago no pudo completarse ğŸ˜¢  
        Por favor intenta nuevamente. Milo te lo agradecerÃ­a muchÃ­simo.
        </p>
    </div>
    {% endif %}

    {% if request.GET.pending %}
    <div class="mt-4 p-3 rounded-md bg-yellow-50 border border-yellow-300">
        <p class="text-yellow-800 font-semibold">
        Tu pago estÃ¡ siendo procesado ğŸ’›  
        Te avisaremos por correo apenas se confirme.  
        Â¡Gracias por ayudar a Milo!
        </p>
    </div>
    {% endif %}
  </div>

  <div class="bg-white rounded-xl shadow p-4 space-y-4">
    <div>
      <label for="donation_amount" class="block text-sm font-medium mb-1">
        Monto de tu donaciÃ³n (CLP)
      </label>
      <input
        id="donation_amount"
        type="number"
        min="1000"
        step="500"
        placeholder="Ej: 5000"
        class="w-full border rounded px-3 py-2"
      >
      <p class="text-xs text-gray-500 mt-1">
        Sugerencia: mÃ­nimo $1.000 CLP, puedes escribir el monto que quieras.
      </p>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Nombre</label>
      <input id="buyer_name" type="text"
             class="w-full border rounded px-3 py-2" required>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Email</label>
      <input id="buyer_email" type="email"
             class="w-full border rounded px-3 py-2" required>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">TelÃ©fono (opcional)</label>
      <input id="buyer_phone" type="text"
             class="w-full border rounded px-3 py-2">
    </div>

    <div class="rounded-lg border p-3 text-sm bg-gray-50">
      <div><strong>Monto:</strong> $<span id="donation-amount-display">0</span> CLP</div>
      <p class="text-xs text-gray-500 mt-1">
        El botÃ³n de pago aparecerÃ¡ cuando ingreses un monto vÃ¡lido y tus datos.
      </p>
    </div>

    <!-- Contenedor del Wallet Brick -->
    <div id="walletBrick_container" class="mt-4 hidden"></div>
  </div>

  <!-- Datos de transferencia, por si alguien prefiere donar asÃ­ -->
  <div class="mt-8">
    <div class="rounded-lg border bg-white p-4 shadow-sm">
      <p class="text-sm font-semibold mb-2">Â¿Prefieres donar por transferencia bancaria?</p>
      <dl class="text-sm space-y-1">
        <div class="flex justify-between">
          <dt class="text-gray-500">Banco</dt>
          <dd class="font-medium">Mercado Pago</dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-gray-500">Tipo de cuenta</dt>
          <dd class="font-medium">Cuenta Vista</dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-gray-500">NÂ° de cuenta</dt>
          <dd class="font-medium">1052076645</dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-gray-500">RUT</dt>
          <dd class="font-medium">20.096.901-4</dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-gray-500">Nombre</dt>
          <dd class="font-medium">Marcelo Pizarro</dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-gray-500">Correo</dt>
          <dd class="font-medium">marcelo.pizarrotapia@gmail.com</dd>
        </div>
      </dl>
      <p class="mt-3 text-xs text-gray-600">
        Por favor envÃ­a el comprobante de transferencia al correo indicado,
        seÃ±alando que es una donaciÃ³n para Milo.
      </p>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
  <script src="{% static 'js/donation.js' %}" defer></script>
{% endblock %}
